!function(t,n,e,o){function s(n,e){if(this.element=n,this.options=t.extend(!0,{},a,e),this.options.events.length&&(this.options.multiDayEvents?this.options.events=this.addMultiDayMomentObjectsToEvents(this.options.events):this.options.events=this.addMomentObjectToEvents(this.options.events)),this.options.startWithMonth?this.month=moment(this.options.startWithMonth).startOf("month"):this.month=moment().startOf("month"),this.options.constraints){if(this.options.constraints.startDate){var o=moment(this.options.constraints.startDate);this.month.isBefore(o,"month")&&(this.month.set("month",o.month()),this.month.set("year",o.year()))}if(this.options.constraints.endDate){var s=moment(this.options.constraints.endDate);this.month.isAfter(s,"month")&&this.month.set("month",s.month()).set("year",s.year())}}this._defaults=a,this._name=i,this.init()}var i="clndr",a={template:"<div class='clndr-controls'><div class='clndr-control-button'><p class='clndr-previous-button'>previous</p></div><div class='month'><%= month %> <%= year %></div><div class='clndr-control-button rightalign'><p class='clndr-next-button'>next</p></div></div><table class='clndr-table' border='0' cellspacing='0' cellpadding='0'><thead><tr class='header-days'><% for(var i = 0; i < daysOfTheWeek.length; i++) { %><td class='header-day'><%= daysOfTheWeek[i] %></td><% } %></tr></thead><tbody><% for(var i = 0; i < numberOfRows; i++){ %><tr><% for(var j = 0; j < 7; j++){ %><% var d = j + i * 7; %><td class='<%= days[d].classes %>'><div class='day-contents'><%= days[d].day %></div></td><% } %></tr><% } %></tbody></table>",weekOffset:0,startWithMonth:null,clickEvents:{click:null,nextMonth:null,previousMonth:null,nextYear:null,previousYear:null,today:null,onMonthChange:null,onYearChange:null},targets:{nextButton:"clndr-next-button",previousButton:"clndr-previous-button",nextYearButton:"clndr-next-year-button",previousYearButton:"clndr-previous-year-button",todayButton:"clndr-today-button",day:"day",empty:"empty"},events:[],extras:null,dateParameter:"date",multiDayEvents:null,doneRendering:null,render:null,daysOfTheWeek:null,showAdjacentMonths:!0,adjacentDaysChangeMonth:!1,ready:null,constraints:null};s.prototype.init=function(){if(this.daysOfTheWeek=this.options.daysOfTheWeek||[],!this.options.daysOfTheWeek){this.daysOfTheWeek=[];for(var n=0;n<7;n++)this.daysOfTheWeek.push(moment().weekday(n).format("dd").charAt(0))}if(this.options.weekOffset&&(this.daysOfTheWeek=this.shiftWeekdayLabels(this.options.weekOffset)),!t.isFunction(this.options.render)){if(this.options.render=null,"undefined"==typeof _)throw new Error("Underscore was not found. Please include underscore.js OR provide a custom render function.");this.compiledClndrTemplate=_.template(this.options.template)}t(this.element).html("<div class='clndr'></div>"),this.calendarContainer=t(".clndr",this.element),this.bindEvents(),this.render(),this.options.ready&&this.options.ready.apply(this,[])},s.prototype.shiftWeekdayLabels=function(t){for(var n=this.daysOfTheWeek,e=0;e<t;e++)n.push(n.shift());return n},s.prototype.createDaysObject=function(n){daysArray=[];var e=n.startOf("month");if(this.eventsLastMonth=[],this.eventsThisMonth=[],this.eventsNextMonth=[],this.options.events.length)if(this.options.multiDayEvents){if(this.eventsThisMonth=t(this.options.events).filter(function(){return this._clndrStartDateObject.format("YYYY-MM")==n.format("YYYY-MM")||this._clndrEndDateObject.format("YYYY-MM")==n.format("YYYY-MM")}).toArray(),this.options.showAdjacentMonths){var o=n.clone().subtract("months",1),s=n.clone().add("months",1);this.eventsLastMonth=t(this.options.events).filter(function(){return this._clndrStartDateObject.format("YYYY-MM")==o.format("YYYY-MM")||this._clndrEndDateObject.format("YYYY-MM")==o.format("YYYY-MM")}).toArray(),this.eventsNextMonth=t(this.options.events).filter(function(){return this._clndrStartDateObject.format("YYYY-MM")==s.format("YYYY-MM")||this._clndrEndDateObject.format("YYYY-MM")==s.format("YYYY-MM")}).toArray()}}else if(this.eventsThisMonth=t(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==n.format("YYYY-MM")}).toArray(),this.options.showAdjacentMonths){var o=n.clone().subtract("months",1),s=n.clone().add("months",1);this.eventsLastMonth=t(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==o.format("YYYY-MM")}).toArray(),this.eventsNextMonth=t(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM")==s.format("YYYY-MM")}).toArray()}var i=e.weekday()-this.options.weekOffset;if(i<0&&(i+=7),this.options.showAdjacentMonths)for(r=0;r<i;r++){h=moment([n.year(),n.month(),r-i+1]);daysArray.push(this.createDayObject(h,this.eventsLastMonth))}else for(r=0;r<i;r++)daysArray.push(this.calendarDay({classes:this.options.targets.empty+" last-month"}));for(var a=e.daysInMonth(),r=1;r<=a;r++){h=moment([n.year(),n.month(),r]);daysArray.push(this.createDayObject(h,this.eventsThisMonth))}if(this.options.showAdjacentMonths)for(r=1;daysArray.length%7!=0;){var h=moment([n.year(),n.month(),a+r]);daysArray.push(this.createDayObject(h,this.eventsNextMonth)),r++}else for(r=1;daysArray.length%7!=0;)daysArray.push(this.calendarDay({classes:this.options.targets.empty+" next-month"})),r++;return daysArray},s.prototype.createDayObject=function(t,n){var e=[],o=moment(),s=this,i=0,a=n.length;for(i;i<a;i++)if(s.options.multiDayEvents){var r=n[i]._clndrStartDateObject,h=n[i]._clndrEndDateObject;(t.isSame(r,"day")||t.isAfter(r,"day"))&&(t.isSame(h,"day")||t.isBefore(h,"day"))&&e.push(n[i])}else n[i]._clndrDateObject.date()==t.date()&&e.push(n[i]);var c="";return o.format("YYYY-MM-DD")==t.format("YYYY-MM-DD")&&(c+=" today"),t.isBefore(o,"day")&&(c+=" past"),e.length&&(c+=" event"),this.month.month()>t.month()?(c+=" adjacent-month",this.month.year()===t.year()?c+=" last-month":c+=" next-month"):this.month.month()<t.month()&&(c+=" adjacent-month",this.month.year()===t.year()?c+=" next-month":c+=" last-month"),this.options.constraints&&(this.options.constraints.startDate&&t.isBefore(moment(this.options.constraints.startDate))&&(c+=" inactive"),this.options.constraints.endDate&&t.isAfter(moment(this.options.constraints.endDate))&&(c+=" inactive")),!t.isValid()&&t.hasOwnProperty("_d")&&void 0!=t._d&&(t=moment(t._d)),c+=" calendar-day-"+t.format("YYYY-MM-DD"),this.calendarDay({day:t.date(),classes:this.options.targets.day+c,events:e,date:t})},s.prototype.render=function(){this.calendarContainer.children().remove();var t=this.createDaysObject(this.month),n=(this.month,{daysOfTheWeek:this.daysOfTheWeek,numberOfRows:Math.ceil(t.length/7),days:t,month:this.month.format("MMMM"),year:this.month.year(),eventsThisMonth:this.eventsThisMonth,eventsLastMonth:this.eventsLastMonth,eventsNextMonth:this.eventsNextMonth,extras:this.options.extras});if(this.options.render?this.calendarContainer.html(this.options.render.apply(this,[n])):this.calendarContainer.html(this.compiledClndrTemplate(n)),this.options.constraints){for(target in this.options.targets)target!=this.options.targets.day&&this.element.find("."+this.options.targets[target]).toggleClass("inactive",!1);var e=null,o=null;this.options.constraints.startDate&&(e=moment(this.options.constraints.startDate)),this.options.constraints.endDate&&(o=moment(this.options.constraints.endDate)),e&&this.month.isSame(e,"month")&&this.element.find("."+this.options.targets.previousButton).toggleClass("inactive",!0),o&&this.month.isSame(o,"month")&&this.element.find("."+this.options.targets.nextButton).toggleClass("inactive",!0),e&&moment(e).subtract("years",1).isBefore(moment(this.month).subtract("years",1))&&this.element.find("."+this.options.targets.previousYearButton).toggleClass("inactive",!0),o&&moment(o).add("years",1).isAfter(moment(this.month).add("years",1))&&this.element.find("."+this.options.targets.nextYearButton).toggleClass("inactive",!0),(e&&e.isAfter(moment(),"month")||o&&o.isBefore(moment(),"month"))&&this.element.find("."+this.options.targets.today).toggleClass("inactive",!0)}this.options.doneRendering&&this.options.doneRendering.apply(this,[])},s.prototype.bindEvents=function(){var n=t(this.element),e=this;n.on("click","."+this.options.targets.day,function(n){if(e.options.clickEvents.click){var o=e.buildTargetObject(n.currentTarget,!0);e.options.clickEvents.click.apply(e,[o])}e.options.adjacentDaysChangeMonth&&(t(n.currentTarget).is(".last-month")?e.backActionWithContext(e):t(n.currentTarget).is(".next-month")&&e.forwardActionWithContext(e))}),n.on("click","."+this.options.targets.empty,function(n){if(e.options.clickEvents.click){var o=e.buildTargetObject(n.currentTarget,!1);e.options.clickEvents.click.apply(e,[o])}e.options.adjacentDaysChangeMonth&&(t(n.currentTarget).is(".last-month")?e.backActionWithContext(e):t(n.currentTarget).is(".next-month")&&e.forwardActionWithContext(e))}),n.on("click","."+this.options.targets.previousButton,{context:this},this.backAction).on("click","."+this.options.targets.nextButton,{context:this},this.forwardAction).on("click","."+this.options.targets.todayButton,{context:this},this.todayAction).on("click","."+this.options.targets.nextYearButton,{context:this},this.nextYearAction).on("click","."+this.options.targets.previousYearButton,{context:this},this.previousYearAction)},s.prototype.buildTargetObject=function(n,e){var o={element:n,events:[],date:null};if(e){var s,i=n.className.indexOf("calendar-day-");0!==i?(s=n.className.substring(i+13,i+23),o.date=moment(s)):o.date=null,this.options.events&&(this.options.multiDayEvents?o.events=t.makeArray(t(this.options.events).filter(function(){return(o.date.isSame(this._clndrStartDateObject,"day")||o.date.isAfter(this._clndrStartDateObject,"day"))&&(o.date.isSame(this._clndrEndDateObject,"day")||o.date.isBefore(this._clndrEndDateObject,"day"))})):o.events=t.makeArray(t(this.options.events).filter(function(){return this._clndrDateObject.format("YYYY-MM-DD")==s})))}return o},s.prototype.forwardAction=function(t){var n=t.data.context;n.forwardActionWithContext(n)},s.prototype.backAction=function(t){var n=t.data.context;n.backActionWithContext(n)},s.prototype.backActionWithContext=function(t){if(!t.element.find("."+t.options.targets.previousButton).hasClass("inactive")){var n=!t.month.isSame(moment(t.month).subtract("months",1),"year");t.month.subtract("months",1),t.render(),t.options.clickEvents.previousMonth&&t.options.clickEvents.previousMonth.apply(t,[moment(t.month)]),t.options.clickEvents.onMonthChange&&t.options.clickEvents.onMonthChange.apply(t,[moment(t.month)]),n&&t.options.clickEvents.onYearChange&&t.options.clickEvents.onYearChange.apply(t,[moment(t.month)])}},s.prototype.forwardActionWithContext=function(t){if(!t.element.find("."+t.options.targets.nextButton).hasClass("inactive")){var n=!t.month.isSame(moment(t.month).add("months",1),"year");t.month.add("months",1),t.render(),t.options.clickEvents.nextMonth&&t.options.clickEvents.nextMonth.apply(t,[moment(t.month)]),t.options.clickEvents.onMonthChange&&t.options.clickEvents.onMonthChange.apply(t,[moment(t.month)]),n&&t.options.clickEvents.onYearChange&&t.options.clickEvents.onYearChange.apply(t,[moment(t.month)])}},s.prototype.todayAction=function(t){var n=t.data.context,e=!n.month.isSame(moment(),"month"),o=!n.month.isSame(moment(),"year");n.month=moment().startOf("month"),n.options.clickEvents.today&&n.options.clickEvents.today.apply(n,[moment(n.month)]),e&&(n.render(),n.month=moment(),n.options.clickEvents.onMonthChange&&n.options.clickEvents.onMonthChange.apply(n,[moment(n.month)]),o&&n.options.clickEvents.onYearChange&&n.options.clickEvents.onYearChange.apply(n,[moment(n.month)]))},s.prototype.nextYearAction=function(t){var n=t.data.context;n.element.find("."+n.options.targets.nextYearButton).hasClass("inactive")||(n.month.add("years",1),n.render(),n.options.clickEvents.nextYear&&n.options.clickEvents.nextYear.apply(n,[moment(n.month)]),n.options.clickEvents.onMonthChange&&n.options.clickEvents.onMonthChange.apply(n,[moment(n.month)]),n.options.clickEvents.onYearChange&&n.options.clickEvents.onYearChange.apply(n,[moment(n.month)]))},s.prototype.previousYearAction=function(t){var n=t.data.context;n.element.find("."+n.options.targets.previousYear).hasClass("inactive")||(n.month.subtract("years",1),n.render(),n.options.clickEvents.previousYear&&n.options.clickEvents.previousYear.apply(n,[moment(n.month)]),n.options.clickEvents.onMonthChange&&n.options.clickEvents.onMonthChange.apply(n,[moment(n.month)]),n.options.clickEvents.onYearChange&&n.options.clickEvents.onYearChange.apply(n,[moment(n.month)]))},s.prototype.forward=function(t){return this.month.add("months",1),this.render(),t&&t.withCallbacks&&(this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)]),0===this.month.month()&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)])),this},s.prototype.back=function(t){return this.month.subtract("months",1),this.render(),t&&t.withCallbacks&&(this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)]),11===this.month.month()&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)])),this},s.prototype.next=function(t){return this.forward(t),this},s.prototype.previous=function(t){return this.back(t),this},s.prototype.setMonth=function(t,n){return this.month.month(t),this.render(),n&&n.withCallbacks&&this.options.clickEvents.onMonthChange&&this.options.clickEvents.onMonthChange.apply(this,[moment(this.month)]),this},s.prototype.nextYear=function(t){return this.month.add("year",1),this.render(),t&&t.withCallbacks&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]),this},s.prototype.previousYear=function(t){return this.month.subtract("year",1),this.render(),t&&t.withCallbacks&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]),this},s.prototype.setYear=function(t,n){return this.month.year(t),this.render(),n&&n.withCallbacks&&this.options.clickEvents.onYearChange&&this.options.clickEvents.onYearChange.apply(this,[moment(this.month)]),this},s.prototype.setEvents=function(t){return this.options.multiDayEvents?this.options.events=this.addMultiDayMomentObjectsToEvents(t):this.options.events=this.addMomentObjectToEvents(t),this.render(),this},s.prototype.addEvents=function(n){return this.options.multiDayEvents?this.options.events=t.merge(this.options.events,this.addMultiDayMomentObjectsToEvents(n)):this.options.events=t.merge(this.options.events,this.addMomentObjectToEvents(n)),this.render(),this},s.prototype.addMomentObjectToEvents=function(t){var n=this,e=0,o=t.length;for(e;e<o;e++)t[e]._clndrDateObject=moment(t[e][n.options.dateParameter]);return t},s.prototype.addMultiDayMomentObjectsToEvents=function(t){var n=this,e=0,o=t.length;for(e;e<o;e++)t[e]._clndrStartDateObject=moment(t[e][n.options.multiDayEvents.startDate]),t[e]._clndrEndDateObject=moment(t[e][n.options.multiDayEvents.endDate]);return t},s.prototype.calendarDay=function(n){var e={day:"",classes:this.options.targets.empty,events:[],date:null};return t.extend({},e,n)},t.fn.clndr=function(n){if(!t.data(this,"plugin_clndr")){var e=new s(this,n);return t.data(this,"plugin_clndr",e),e}}}(jQuery,window,document);